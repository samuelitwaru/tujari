<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Amobit e-commerce</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">
    <!-- Bootstrap CSS-->
    <link rel="stylesheet" href="{{ url_for('static', filename='vendor/bootstrap/css/bootstrap.min.css')}}">
    <!-- Font Awesome CSS-->
    <link rel="stylesheet" href="{{ url_for('static', filename='vendor/font-awesome/css/font-awesome.min.css')}}">
    <!-- Google fonts - Roboto -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,700">
    <!-- owl carousel-->
    <!-- theme stylesheet-->
    <!-- Custom stylesheet - for your changes-->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/custom.css') }}">
    <!-- Favicon-->
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.png') }}">
  
  </head>
  <body>
  <header class="header">
    <!--
    *** TOPBAR ***
    _________________________________________________________
    -->
    <div class="d-none d-sm-block d-md-block d-lg-block p-1 bg-dark">
      <div class="container-fluid">
        <div class="row">
          <div class="ml-auto">
            <ul class="nav mb-0 mr-4">
              {% if not current_user.is_authenticated %}
                <li class="nav-item dropdown">
                  <a class="nav-link text-white"  data-toggle="dropdown" data-hover="dropdown" id="dropdownMenuButton" >Login</a>
                  <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                    <li class="dropdown-item">
                      <a class="text-body nav-link" href="{{url_for('vendors.login')}}">
                        <i class="fa fa-user"></i>
                        Vendor
                      </a>
                    </li>
                    <li class="dropdown-item"> 
                      <a class="text-body nav-link" href="{{url_for('customers.login')}}">
                        <i class="fa fa-user-circle"></i>
                        consumer
                      </a>
                    </li>

                  </ul>
                </li>
      
                <li class="nav-item dropdown"><a class="nav-link text-white"  data-toggle="dropdown" data-hover="dropdown" id="dropdownMenuButton">Register</a>
                  <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                    <li class="dropdown-item">
                      <a class="text-body nav-link" href="{{url_for('vendors.register')}}">
                        <i class="fa fa-user"></i>
                        Vendor
                      </a>
                    </li>
                    <li class="dropdown-item">
                      <a class="text-body nav-link" href="{{ url_for('customers.register')}}">
                        <i class="fa fa-user-circle"></i>
                        Customer
                      </a> 
                    </li>

                  </ul>
                </li>
              {% endif %}
              <li class="nav-item "><a class="nav-link text-white" href="{{url_for('customers.contact')}}">Contact</a></li>
              {% if current_user.is_authenticated %}
                <li class="nav-item "><a class="nav-link text-white" href="{{ url_for('customers.getrecentlyViewed')}}">Recently viewed</a></li>
              {% endif %}
              <li class="nav-item "><a class="nav-link text-white" href="">Help</a></li>
              {% if current_user.is_authenticated %}
                <li class="nav-item ">
                  <div id="" class="dropdown">
                    <button class="btn btn-secondary dropdown-toggle" type="button" id="dp" data-toggle='dropdown'>
                      <i class="fa fa-user"></i><span> {{ current_user.user_name }}</span>
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="dp">
                      <li class="dropdown-item">
                        <a class="text-body" href="{{ url_for('customers.logout') }}"><i class="fa fa-sign-out"></i> Logout</a>
                      </li>
                      <li class="dropdown-item">
                        <a class="text-body" href="{{ url_for('account.update_account') }}"><i class="fa fa-list"></i> View Account</a>
                      </li>
                    </ul>
                  </div>
                </li>
              {% endif %}
            </ul>
            
          </div>
        </div>
      </div>

      <!-- *** TOP BAR END ***-->
    
    </div>
    <nav class="navbar navbar-expand-sm">
      <a href="#" class="navbar-brand">
        <img src="{{ url_for ('static',filename='images/logo.PNG') }}" alt="logo" class="d-inline-block align-top">
      </a>
      <button class="navbar-toggler bg-dark" type="button" data-toggle="collapse" data-target="#itemsNavbar" aria-controls="itemsNavbar" aria-expanded="false" aria-label="Toggle Navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="itemsNavbar">
        <ul class="navbar-nav">
          {% if not current_user.is_authenticated %}
            <li class="nav-item dropdown d-block d-sm-none d-md-none d-lg-none"><a class="nav-link"  data-toggle="dropdown" data-hover="dropdown" id="dropdownMenuButton" >Login</a>
              <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                <li class="dropdown-item">
                  <a class="text-body nav-link" href="{{url_for('vendors.login')}}">
                    <i class="fa fa-user"></i>
                    Vendor
                  </a>
                </li>
                <li class="dropdown-item"> 
                  <a class="text-body nav-link" href="{{url_for('customers.login')}}">
                    <i class="fa fa-user-circle"></i>
                    consumer
                  </a>
                </li>

              </ul>
            </li>
  
            <li class="nav-item dropdown d-block d-sm-none d-md-none d-lg-none"><a class="nav-link"  data-toggle="dropdown" data-hover="dropdown" id="dropdownMenuButton">Register</a>
              <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                <li class="dropdown-item">
                  <a class="text-body nav-link" href="{{url_for('vendors.register')}}">
                    <i class="fa fa-user"></i>
                    Vendor
                  </a>
                </li>
                <li class="dropdown-item">
                  <a class="text-body nav-link" href="{{ url_for('customers.register')}}">
                    <i class="fa fa-user-circle"></i>
                    Customer
                  </a> 
                </li>

              </ul>
            </li>
            {% endif %}
            <li class="nav-item d-block d-sm-none d-md-none d-lg-none"><a class="nav-link" href="{{url_for('customers.contact')}}">Contact</a></li>
            {% if current_user.is_authenticated %}
              <li class="nav-item d-block d-sm-none d-md-none d-lg-none"><a class="nav-link" href="{{ url_for('customers.getrecentlyViewed')}}">Recently viewed</a></li>
            {% endif %}
            <li class="nav-item d-block d-sm-none d-md-none d-lg-none"><a class="nav-link" href="">Help</a></li>
            {% if current_user.is_authenticated %}
              <li class="nav-item d-block d-sm-none d-md-none d-lg-none">
                <div id="" class="dropdown">
                  <button class="btn btn-secondary dropdown-toggle" type="button" id="dp" data-toggle='dropdown'>
                    <i class="fa fa-user"></i><span>{{ current_user.user_name }}</span>
                  </button>
                  <ul class="dropdown-menu" aria-labelledby="dp">
                    <li class="dropdown-item">
                      <a class="text-body" href="{{ url_for('customers.logout') }}"><i class="fa fa-sign-out"></i>Logout</a>
                    </li>
                    <li class="dropdown-item">
                      <a class="text-body" href="{{ url_for('customers.customer_account') }}"><i class="fa fa-list"></i>View Account</a>
                    </li>
                  </ul>
                </div>
              </li>
            {% endif %}
          <li class="nav-item btn-group d-none d-sm-block d-md-block d-lg-block">
            <a href="#" id="toggler" role="button" class="btn btn-outline-secondary rounded btn-md" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <i class="fa fa-align-justify"></i>
            </a>
            
            <div class="dropdown-menu" aria-labelledby="toggler">
              
              {% for category in session.categories_menu %}
                <div class="dropdown-item dropright">
                  <a href="#" role="button" class="nav-item nav-link" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">{{ category["name"] }}</a>
                  <div class="dropdown-menu d-flex flex-column py-0" style="width: 35rem;">
                    <div class="d-flex flex-wrap">
                      {% if category["sub_category"] %}
                        {% for subcategory in category["sub_category"] %}
                          <div class="card border-0 shadow-none flex-fill">
                            <div class="card-body">
                              <h5 class="card-title"><a class="text-dark" href="{{ url_for('customers.sub_category', id=subcategory['id']) }}">{{ subcategory["name"] }}</a></h5>
                              <div class=" d-flex flex-column">
                                {% if subcategory["product"] %}
                                  {% for product in subcategory["product"] %}
                                    <div><a class="text-decoration-none text-wrap" href="#">{{ product["name"] }}</a></div>
                                  {% endfor %}
                                  {% else %}
                                  <div>
                                    <small class="text-muted">Items for this category are coming soon</small>
                                  </div>
                                {% endif %}
                              </div>
                            </div>
                          </div>
                        {% endfor %}
                        {% else %}
                          <div>
                            <small class="text-muted">Items for this category are coming soon</small>
                          </div>
                      {% endif %}
                    </div>
                  </div>
                </div>
              {% endfor %}
            </div>
          </li>
          <li class="nav-item d-block d-sm-none d-md-none d-lg-none mt-2">
            <a href="#" id="available_categories_toggler" role="button" data-toggle="collapse" class="btn btn-outline-secondary rounded-0" data-target="#available_categories" aria-expanded="false" aria-controls="available_categories">
              Available Items
            </a>
            <div class="row">
              <div class="col" id="available_categories" class="collapse">
                <div class="accordion" id="accordionMenu">
                  {% for category in session.categories_menu %}
                  <div class="card rounded-0">
                    <div class="card-header py-2" id="hdr-{{category['id']}}">
                      <a href="#" class="nav-link py-0" role="button" data-toggle="collapse" data-target="#elmt-{{category['id']}}" aria-expanded="false" aria-controls="elmt-{{category['id']}}">
                        {{ category["name"] }}
                      </a>
                    </div>
                    <div id="elmt-{{category['id']}}" class="collapse" aria-labelledby="hdr-{{category['id']}}" data-parent="#accordionMenu">
                      <div class="card-body p-3">
                        {% for subcategory in category["sub_category"] %}
                        <div class="nav-item ml-2" class="collapse">
                          <h5 class="card-title mb-1">
                            <a href="#" class="nav-link text-decoration-none py-0 text-dark">
                              {{ subcategory["name"] }}
                            </a>
                          </h5>
                          <div class="d-flex flex-row flex-wrap justify-content-between">
                            {% if subcategory["product"] %}
                              {% for product in subcategory["product"] %}
                                <div>
                                  <a class="text-decoration-none text-wrap" href="#"> {{ product["name"] }}</a>
                                </div>
                              {% endfor %}
                              {% else %}
                                <div>
                                  <small class="text-muted">Items for this category will be available soon</small>
                                </div>
                            {% endif %}
                        </div>
                        </div>
                      {% endfor %}
                      </div>
                    </div>
                  </div>
                  {% endfor %}
                </div>
                
              </div>
            </div>
          </li>
        </ul>
            <form id="searchForm" role="search" class="form-inline ml-auto w-50">
              <div class="input-group flex-nowrap w-100 mw-auto">
                <input type="text" placeholder="Search Item or category" class="form-control">
                <div class="input-group-append">
                  <button type="button" class="btn btn-primary"><i class="fa fa-search"></i></button>
                </div>
              </div>
            </form>
            {% if current_user.is_authenticated %}
          <ul class="nav ml-auto">
            <li class="nav-item">
              <a href="{{ url_for('customers.orders') }}" class="btn btn-outline-info">
                <i class="fa fa-shopping-basket"></i>
                <span>Orders</span>
              </a>
            </li>
            
            {% if session.cart_len %}
              <li class="nav-item mx-1">
                <a href="{{ url_for('customers.basket') }}" class="btn btn-outline-info d-inline-block">
                  <i class="fa fa-shopping-cart"></i>
                  <span class="badge">
                    {{ session.cart_len }}
                  </span>
                </a>
              </li>
            {% else %}
              <li class="nav-item mx-1">
                <a href="{{ url_for('customers.basket') }}" class="btn btn-outline-info d-inline-block">
                  <i class="fa fa-shopping-cart"></i>
                  <span class="badge">
                    0
                  </span>
                </a>
              </li>
            {% endif %}
            </ul>
        {% endif %}
      </div>
    </nav>

  </header>
    <div class="row" style="margin-top: 5px;">
      <div class="col-md-3"></div>
      <div class="col-md-6">
        {% with messages = get_flashed_messages(with_categories=true)%}
          {% if messages %}
            {% for category,message in messages%}
              <div class="alert alert-{{ category}} alert-dismissible text-center">
                <strong>{{ message }}</strong>
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
            {% endfor%}
          {% endif %}
        {% endwith %}
      </div>
      <div class="col-md-3"></div>
    </div>
    {% block body%}
    {%endblock%}
     <!--
    *** FOOTER ***
    _________________________________________________________
    -->
    <footer class="border-top border-0" style="background-color: #e0e0e0;">
      <div class="container py-5">
        <div class="row pt-5">
          <div class="col-lg-3 col-md-6 col-sm-6">
            <h4 class="mb-3">Pages</h4>
            <ul class="list-unstyled">
              <li><a href="#">About us</a></li>
              <li><a href="#">Terms and conditions</a></li>
              <li><a href="#">FAQ</a></li>
              <li><a href="@">Contact us</a></li>
            </ul>
            <hr>
            {% if not current_user.is_authenticated %}
              <h4 class="mb-3">User section</h4>
              <ul class="list-unstyled">
                <li><a href="#" data-toggle="modal" data-target="#login-modal">Login</a></li>
                <li><a href="#">Register</a></li>
              </ul>
            {% endif %}
          </div>
          <!-- /.col-lg-3-->
          <div class="col-lg-3 col-md-6 col-sm-6">
            <h4 class="mb-3">Top categories</h4>
            <h5 class="font-weight-bolder">Fashion</h5>
            <ul class="list-unstyled">
              <li><a href="{{ url_for('customers.category') }}">Mens Fashion</a></li>
              <li><a href="{{ url_for('customers.category') }}">Ladies Fashion</a></li>
              <li><a href="{{ url_for('customers.category') }}">Babys Fashion</a></li>
              <li><a href="{{ url_for('customers.category') }}">Wedding</a></li>

            </ul>
            <h5 class="font-weight-bold">Computing</h5>
            <ul class="list-unstyled">
              <li><a href="{{ url_for('customers.category') }}">Laptops</a></li>
              <li><a href="{{ url_for('customers.category') }}">Phones</a></li>
              <li><a href="{{ url_for('customers.category') }}">Computer Accessories</a></li>
            </ul>
          </div>
          <!-- /.col-lg-3-->
          <div class="col-lg-3 col-md-6 col-sm-6">
            <h4 class="mb-3">Where to find us</h4>
            <p><strong>Amobit Tech Ltd.</strong><br>Euata Trading Center<br>New Heaven<br>45Y 73J<br>Arua<br><strong>Uganda</strong></p>
            <hr class="d-block d-md-none">
          </div>
          <!-- /.col-lg-3-->
          <div class="col-lg-3 col-md-6 col-sm-6">
            <h4 class="mb-3">Get the news</h4>
            <form>
              <div class="input-group">
                <input type="text" class="form-control"><span class="input-group-append">
                  <button type="button" class="btn btn-outline-primary">Subscribe!</button></span>
              </div>
              <!-- /input-group-->
            </form>
            <hr>
            <h4 class="mb-3">Stay in touch</h4>
            <p>
              <a href="#" class="facebook external">
                <i class="fa fa-facebook"></i>
              </a>
              <a href="#" class="twitter external">
                <i class="fa fa-twitter"></i>
              </a>
              <a href="#" class="instagram external">
                <i class="fa fa-instagram"></i>
              </a>
              <a href="#" class="gplus external">
                <i class="fa fa-google-plus"></i>
              </a><a href="#" class="email external">
                <i class="fa fa-envelope"></i>
              </a>
            </p>
          </div>
          <!-- /.col-lg-3-->
        </div>
      </div>
      <div class="bg-dark">
        <div class="container-fluid">
          <div class="row justify-content-center">
            <div class="col-12">
              <p class="text-center text-white mb-0">©2020 Amobit Technologies</p>
            </div>
   <!-- If you want to remove this backlink, pls purchase an Attribution-free License @ https://bootstrapious.com/p/obaju-e-commerce-template. Big thanks!-->
  
      </div>
      </div>
      </div>
    </footer>

      <script src="{{ url_for ('static',filename='vendor/jquery/jquery.min.js') }}"></script>
      <script src="{{url_for ('static',filename='vendor/bootstrap/js/bootstrap.bundle.min.js') }}"></script>
      <script type="text/javascript">
        $(document).ready(
          // function(){
          //   var menu = $("#toggler").next()
          //   var dropDownItems = $(menu).children(".dropdown-item, .dropright")
          //   var parent = $(menu).parent()
           
          //   $(parent).on("show.bs.dropdown", function(){
          //     if(!$(menu).hasClass("d-sm-block")){
          //       $(menu).addClass("d-sm-block")
          //     }
          //     $(dropDownItems).each(function(ind, e){
          //       var subMenu = $(e).children(".dropdown-menu, .d-flex, .flex-column")[0]
          //       if(!$(subMenu).hasClass("d-sm-none")){
          //         $(subMenu).addClass("d-sm-none")
          //       }
          //     })
          //     $(dropDownItems).each(function(ind, e){
          //       var subMenu = $(e).children(".dropdown-menu, .d-flex, .flex-column")[0]
          //       var category = $(e).children("a")[0]
          //       $(category).on("mousedown",function(){
          //         if($(subMenu).hasClass("d-sm-none")){
          //           $(subMenu).removeClass("d-sm-none")
          //           $(subMenu).addClass("d-sm-block")
                    
          //           var otherCategories = $(e).siblings()
          //           $(otherCategories).each(function(ind2, e2){
          //             var subMenu2 = $(e2).children(".dropdown-menu, .d-flex, .flex-column")[0]
          //             if(!$(subMenu2).hasClass("d-sm-none")){
          //               $(subMenu2).addClass("d-sm-none")
          //             }
          //             if($(subMenu2).hasClass("d-sm-block")){
          //               $(subMenu2).removeClass("d-sm-block")
          //             }
          //           })
          //         }
          //       })
          //     })
              
          //   })
          //   $(parent).on("hide.bs.dropdown", function(){
          //     if($(menu).hasClass("d-sm-block")){
          //       $(menu).removeClass("d-sm-block")
          //     }
          //   })
            
          // }

          ///////////////////////////////////////////////////////////////////
          function(){
            // drop down menu toggling
            var menu = $("#toggler").next()
            var dropDownItems = $(menu).children(".dropdown-item")
            var parent = $(menu).parent()
            var isSubMenu  = false
            $("#toggler").on("mousedown", function(){
              isSubMenu = false
            })
            $(parent).on("shown.bs.dropdown", function(){
              if(!isSubMenu){
                $(dropDownItems).each(function(ind, e){
                  var subMenu = $(e).children(".dropdown-menu, .d-flex, .flex-column")[0]
                  $(subMenu).toggleClass("d-sm-none")
                })
              }
              
              $(dropDownItems).each(function(ind, e){
                var subMenu = $(e).children(".dropdown-menu, .d-flex, .flex-column")[0]
                var category = $(e).children("a")[0]

                $(category).on("mousedown",function(){
                  if($(subMenu).hasClass("d-sm-none")){
                    $(subMenu).toggleClass("d-sm-none")
                    isSubMenu = true
                    var otherCategories = $(e).siblings()
                    $(otherCategories).each(function(ind2, e2){
                      var subMenu2 = $(e2).children(".dropdown-menu, .d-flex, .flex-column")[0]
                      if(!$(subMenu2).hasClass("d-sm-none")){
                        $(subMenu2).toggleClass("d-sm-none")
                      }
                    })
                  }
                  $(e).on("hide.bs.dropdown", function(){
                    if(!$(subMenu).hasClass("d-sm-none")){
                      $(subMenu).toggleClass("d-sm-none")
                    }
                    
                  })
                })
              })
              
            })
            $(parent).on("hidden.bs.dropdown", function(){
              if(isSubMenu){
                $(parent).addClass("show")
                $(menu).addClass("show")
              }else{
                $(dropDownItems).each(function(ind3, e3){
                  var subMenu3 = $(e3).children(".dropdown-menu, .d-flex, .flex-column")[0]
                  if($(subMenu3).hasClass("d-sm-none")){
                    $(subMenu3).toggleClass("d-sm-none")
                  }
                })
              }
            })
            // end of drop down menu
            runChanges();
            $(window).resize(function(){
              runChanges();
            })
            function runChanges(){
              if($(window).width() <= 576){
                // search form
                if($("#searchForm").hasClass("w-50")){
                  $("#searchForm").toggleClass("w-50 w-100 my-3")
                }
                
                // mobile drop down menu
                var newMenu = $("#available_categories")
                var menuToggler = $("#available_categories_toggler")
                if(!$(newMenu).hasClass("d-none")){
                  $(newMenu).toggleClass("d-none")
                }
                $(menuToggler).click(function(){
                  $(newMenu).toggleClass("d-none")
                })
                
              }
              else{
                //search items
                if($("#searchForm").hasClass("w-100")){
                  $("#searchForm").toggleClass("w-50 w-100 my-3")
                }
                $("body").css("font-size","1.2rem")
                
              }
            }
          }



        )

        // function myFunction(x) {
      //   if (x.matches) { // If media query matches
      //     document.body.style.backgroundColor = "yellow";
      //   } else {
      //     document.body.style.backgroundColor = "pink";
      //   }
      // }

      // var x = window.matchMedia("(max-width: 700px)")
      // myFunction(x) // Call listener function at run time
      // x.addListener(myFunction) 
      </script>
</body>


</html>
